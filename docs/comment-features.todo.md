# コメント機能関連 TODO

## コメント基本機能

### コメントの追加

- [x] テキストコメントの追加
  - [x] プレーンテキスト
  - [ ] リッチテキスト
  - [ ] メンション機能
- [x] コメントの位置指定
  - [x] ページ全体へのコメント
  - [ ] 特定ブロックへのコメント
  - [ ] インラインコメント
- [x] コメントの属性設定
  - [x] 作成者情報
  - [x] タイムスタンプ
  - [ ] 重要度フラグ

### コメントの取得

- [x] コメント一覧の取得
  - [x] ページ単位での取得
  - [ ] ブロック単位での取得
  - [ ] フィルタリング機能
- [x] コメントスレッドの取得
  - [x] スレッド構造の解析
  - [x] 返信の関連付け
  - [x] ソート機能
- [x] コメント詳細の取得
  - [x] メタデータの取得
  - [ ] リアクション情報
  - [ ] 既読状態

### コメントの更新

- [ ] コメント内容の編集 ※Notion APIの制限により現在は実装不可
  - [ ] テキストの更新
  - [ ] リッチテキストの編集
  - [ ] メンションの更新
- [ ] コメント属性の更新
  - [ ] 重要度の変更
  - [ ] ラベルの更新
  - [ ] 状態の変更

### コメントの削除

- [ ] 単一コメントの削除 ※Notion APIの制限により現在は実装不可
  - [ ] ソフトデリート
  - [ ] ハードデリート
  - [ ] 復元機能
- [ ] スレッド単位の削除 ※Notion APIの制限により現在は実装不可
  - [ ] 返信の一括削除
  - [ ] 部分的な削除
  - [ ] アーカイブ機能

## コメント管理機能

### コメントスレッド

- [x] スレッド作成
  - [x] 新規スレッドの開始
  - [x] 既存コメントへの返信
  - [ ] スレッドの分岐
- [x] スレッド管理
  - [ ] スレッドのマージ
  - [ ] スレッドの分割
  - [ ] スレッドの移動

### 通知機能

- [ ] コメント通知
  - [ ] メンション通知
  - [ ] スレッド更新通知
  - [ ] カスタム通知設定
- [ ] 通知設定
  - [ ] 通知頻度の設定
  - [ ] 通知方法の選択
  - [ ] フィルター設定

### アクセス制御

- [ ] 権限管理
  - [ ] 閲覧権限
  - [ ] 編集権限
  - [ ] 削除権限
- [ ] プライバシー設定
  - [ ] 公開範囲の設定
  - [ ] 非公開コメント
  - [ ] 期限付きコメント

## 実装済み機能

- ✅ コメント追加: `noti page comment add <ページID> "コメント内容"`
- ✅ コメント取得: `noti page comment get <ページID> [--format json|markdown|thread] [--detail]`
- ✅ コメントスレッド一覧: `noti page comment list-threads <ページID>`
- ✅ コメントスレッドへの返信: `noti page comment reply <ページID> <スレッドID> "返信内容"`

## 実装上の制限事項

- Notion API の制限により、現在以下の機能は実装できません
  - コメントの更新: Notion APIでコメント更新がサポートされていない
  - コメントの削除: Notion APIでコメント削除がサポートされていない
  - 特定ブロックへのコメント: APIの制約によりページ全体へのコメントのみ可能
  - リッチテキスト/メンション: 現在の実装ではプレーンテキストのみサポート

## 優先順位

1. ✅ コメントの基本機能（追加/取得）
2. ✅ コメントスレッド機能
3. 通知機能
4. アクセス制御機能
